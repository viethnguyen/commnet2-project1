<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Common_Classes_Projects_ECE544: Port Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>Port Class Reference</h1>Port class abstacts functions of communication interfaces.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="common_8h-source.html">common.h</a>&gt;</code>
<p>
<p>Inheritance diagram for Port:
<p><center><img src="classPort.png" usemap="#Port_map" border="0" alt=""></center>
<map name="Port_map">
<area href="classReceivingPort.html" alt="ReceivingPort" shape="rect" coords="0,56,124,80">
<area href="classSendingPort.html" alt="SendingPort" shape="rect" coords="134,56,258,80">
<area href="classLossyReceivingPort.html" alt="LossyReceivingPort" shape="rect" coords="0,112,124,136">
</map>
<a href="classPort-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#a0">Port</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a1" doxytag="Port::~Port"></a>
virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#a1">~Port</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deconstructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#a2">init</a> ()=0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a3" doxytag="Port::setAddress"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#a3">setAddress</a> (<a class="el" href="classAddress.html">Address</a> *addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set the port's own address <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a4" doxytag="Port::setRemoteAddress"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#a4">setRemoteAddress</a> (<a class="el" href="classAddress.html">Address</a> *daddr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set the address of the port at the other end of communication link <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a5" doxytag="Port::getRemoteAddr"></a>
<a class="el" href="classAddress.html">Address</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#a5">getRemoteAddr</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get the address of the port at the other end of communication link <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a6" doxytag="Port::closePort"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#a6">closePort</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">close the port <br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">sockaddr *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#b0">setSockAddress</a> (<a class="el" href="classAddress.html">Address</a> *addr, struct sockaddr_in *address)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cast an <a class="el" href="classAddress.html">Address</a> to socket address format  <a href="#b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#b1">decodeSockAddress</a> (<a class="el" href="classAddress.html">Address</a> *addr, struct sockaddr_in *address)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cast a socket address to normal address format  <a href="#b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b2" doxytag="Port::setHostname"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#b2">setHostname</a> (const char *hostname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set hostname of local address <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b3" doxytag="Port::setPort"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#b3">setPort</a> (const short port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set port of local address <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b4" doxytag="Port::setRemoteHostname"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#b4">setRemoteHostname</a> (const char *hostname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set hostname of remote address <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b5" doxytag="Port::setRemotePort"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#b5">setRemotePort</a> (const short port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set port no of a remote address <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b6" doxytag="Port::getSock"></a>
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#b6">getSock</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get the socket file descriptor <br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p0" doxytag="Port::myaddr_"></a>
<a class="el" href="classAddress.html">Address</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#p0">myaddr_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The default address of mine. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p1" doxytag="Port::itsaddr_"></a>
<a class="el" href="classAddress.html">Address</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#p1">itsaddr_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The default address of the other end of communication link. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p2" doxytag="Port::mySockAddress_"></a>
sockaddr_in&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#p2">mySockAddress_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">IN UDP. this will be INADDR_ANY, not really my IP addr. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p3" doxytag="Port::dstSockAddress_"></a>
sockaddr_in&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#p3">dstSockAddress_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">for every outgoing packet of a connection, the destination address. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p4" doxytag="Port::sockfd_"></a>
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPort.html#p4">sockfd_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">socket file descriptor <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Port class abstacts functions of communication interfaces. 
<p>
Port is an abstract class for the interface to send/receive a packet, whether UDP, TCP Socket, or IP raw socket. The common funcitons for a port are defiend here:<ul>
<li>init</li><li>setSocketAddress</li></ul>
<p>
Port is also associated with a pair of address. One Port send to one <a class="el" href="classAddress.html">Address</a> only, no matter the address is unicast or broadcast. 
<p>

<p>
Definition at line <a class="el" href="common_8h-source.html#l00214">214</a> of file <a class="el" href="common_8h-source.html">common.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="Port::Port"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Port::Port           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor. 
<p>
Constructor. 
<p>
Definition at line <a class="el" href="common_8cpp-source.html#l00263">263</a> of file <a class="el" href="common_8cpp-source.html">common.cpp</a>.<div class="fragment"><pre class="fragment">00263           :<a class="code" href="classPort.html#p4">sockfd_</a>(0)
00264 {
00265 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b1" doxytag="Port::decodeSockAddress"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Port::decodeSockAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classAddress.html">Address</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct sockaddr_in *&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
cast a socket address to normal address format 
<p>
Function to interpreate hostname and port from the SocketAddress 
<p>
Definition at line <a class="el" href="common_8cpp-source.html#l00325">325</a> of file <a class="el" href="common_8cpp-source.html">common.cpp</a>.
<p>
Referenced by <a class="el" href="common_8cpp-source.html#l00484">ReceivingPort::receivePacket()</a>.<div class="fragment"><pre class="fragment">00326 {
00327   addr-&gt;<a class="code" href="classAddress.html#a5">setHostname</a>(inet_ntoa(address-&gt;sin_addr));
00328   addr-&gt;<a class="code" href="classAddress.html#a3">setPort</a>(ntohs(address-&gt;sin_port));  
00329 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="Port::init"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual void Port::init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [pure virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function to initialize the port 
<p>
Implemented in <a class="el" href="classSendingPort.html#a3">SendingPort</a>, and <a class="el" href="classReceivingPort.html#a2">ReceivingPort</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="Port::setSockAddress"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct sockaddr * Port::setSockAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classAddress.html">Address</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct sockaddr_in *&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
cast an <a class="el" href="classAddress.html">Address</a> to socket address format 
<p>
Fill sockaddr_in 'address' structure with information taken from 'addr' and return it cast to a 'struct sockaddr'. It handles following situations:<ul>
<li>if hostname is given as empty "", then INADDR_ANY is used in return</li><li>if an IP address is given, then address could be set directly</li><li>if a hostname is given, call gethostbyname() to find the ip address of the hostname from DNS </li></ul>

<p>
Definition at line <a class="el" href="common_8cpp-source.html#l00287">287</a> of file <a class="el" href="common_8cpp-source.html">common.cpp</a>.
<p>
References <a class="el" href="common_8h-source.html#l00175">Address::getHostname()</a>, and <a class="el" href="common_8h-source.html#l00167">Address::getPort()</a>.
<p>
Referenced by <a class="el" href="common_8cpp-source.html#l00448">ReceivingPort::init()</a>, <a class="el" href="common_8cpp-source.html#l00365">SendingPort::init()</a>, and <a class="el" href="common_8cpp-source.html#l00409">SendingPort::sendPacket()</a>.<div class="fragment"><pre class="fragment">00288 {
00289   <span class="keywordtype">char</span> *hostname;
00290   <span class="keywordtype">int</span> port;
00291   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp;
00292   <span class="keyword">struct </span>hostent *hp;
00293 
00294   hostname = addr-&gt;<a class="code" href="classAddress.html#a6">getHostname</a>();
00295   port = addr-&gt;<a class="code" href="classAddress.html#a4">getPort</a>();
00296 
00297   address-&gt;sin_family = AF_INET;
00298   address-&gt;sin_port   = htons((<span class="keywordtype">short</span>)port);
00299       
00300   <span class="keywordflow">if</span> (strcmp(hostname, <span class="stringliteral">""</span>) == 0) {
00301     address-&gt;sin_addr.s_addr = htonl(INADDR_ANY);  
00302   } 
00303   <span class="keywordflow">else</span> {
00304     <span class="comment">//tmp = inet_addr(hostname);  // If an IP address is given</span>
00305     tmp = inet_aton(hostname, &amp;(address-&gt;sin_addr));
00306     <span class="comment">//if(tmp != (unsigned long) INADDR_NONE){    </span>
00307     <span class="comment">//  address-&gt;sin_addr.s_addr = tmp;  </span>
00308     <span class="comment">//}</span>
00309     <span class="keywordflow">if</span> (tmp == 0) 
00310     {  <span class="comment">// if a hostname is passed, call DNS</span>
00311       <span class="keywordflow">if</span> ((hp = gethostbyname(hostname)) == NULL) {
00312         herror(<span class="stringliteral">"gethostbyname"</span>);
00313         <span class="keywordflow">throw</span> <span class="stringliteral">"Error in Resolving hostname!"</span> ;                           
00314       }
00315       memcpy((<span class="keywordtype">char</span> *)&amp;address-&gt;sin_addr, (<span class="keywordtype">char</span> *)hp-&gt;h_addr, hp-&gt;h_length);
00316     }
00317   }
00318   <span class="keywordflow">return</span> (sockaddr*)address;
00319 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="common_8h-source.html">common.h</a><li><a class="el" href="common_8cpp-source.html">common.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Fri Feb 17 17:55:49 2006 for Common_Classes_Projects_ECE544 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
